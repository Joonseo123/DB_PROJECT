<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="FarmDiary">
    <!-- sql문이 작성되는 공간 -->
    
    <!-- 농사일지 목록 조회 쿼리 -->
    <select id="getList" resultType="farmDiary">
        SELECT diary_id,
               diary_date,
               crop_name,
               work_content,
               weather,
               temperature,
               humidity,
               notes
          FROM farm_diary
      ORDER BY diary_date DESC, diary_id DESC
    </select>
    
    <!-- 농사일지 검색 쿼리 -->
    <select id="search" parameterType="string" resultType="farmDiary">
        SELECT diary_id,
               diary_date,
               crop_name,
               work_content,
               weather,
               temperature,
               humidity,
               notes
          FROM farm_diary
         WHERE crop_name LIKE CONCAT('%', #{keyword}, '%')
            OR work_content LIKE CONCAT('%', #{keyword}, '%')
      ORDER BY diary_date DESC, diary_id DESC
    </select>
    
    <!-- 농사일지 저장 쿼리 -->
    <insert id="save" parameterType="farmDiary">
    	INSERT INTO farm_diary ( 
    	                   diary_date,
    	                   crop_name,
    	                   work_content,
    	                   weather,
    	                   temperature,
    	                   humidity,
    	                   notes
    	                   )
    	VALUES 			 ( #{diaryDate}, 
    	 				   #{cropName}, 
    	 				   #{workContent}, 
    	 				   #{weather}, 
    	 				   #{temperature}, 
    	 				   #{humidity}, 
    	 				   #{notes} )
    </insert>
    
    <!-- 농사일지 상세보기 -->
    <select id="detail" parameterType="int" resultType="farmDiary">
    	SELECT diary_id,
    		   diary_date,
    		   crop_name,
    		   work_content,
    		   weather,
    		   temperature,
    		   humidity,
    		   notes
    	 FROM  farm_diary
    	WHERE  diary_id = #{_parameter}
    </select>

	<!-- 농사일지 삭제하기 -->
	<delete id="goDelete" parameterType="int">
		DELETE 
		FROM farm_diary 
		WHERE diary_id = #{_parameter}
	</delete>
	
	<!-- 농사일지 수정하기 -->
	<update id="goUpdate" parameterType="farmDiary">
		UPDATE farm_diary
		   SET diary_date    = #{diaryDate},
		       crop_name     = #{cropName},
		       work_content  = #{workContent},
		       weather       = #{weather},
		       temperature   = #{temperature},
		       humidity      = #{humidity},
		       notes         = #{notes}
		 WHERE diary_id      = #{diaryId}
	</update>
</mapper>

